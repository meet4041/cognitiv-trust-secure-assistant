rules:
  - id: missing-authorization
    languages: [python]
    severity: WARNING
    message: "Route may be missing authorization check"
    metadata:
      category: security
      cwe: "CWE-285: Improper Authorization"
    patterns:
      - pattern: |
          @app.route($ROUTE)
          def $FUNC(...):
              ...
      - pattern-not: |
          @login_required
          @app.route($ROUTE)
          def $FUNC(...):
              ...
      - pattern-not: |
          @app.route("/login")
          def $FUNC(...):
              ...
